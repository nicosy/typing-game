<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Side-Scrolling Typing Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto py-8">
        <h1 class="text-4xl font-bold mb-4 text-center">Side-Scrolling Typing Game</h1>
        <div class="relative">
            <div id="game" class="w-full h-64 bg-white border border-gray-300 overflow-hidden"></div>
            <div id="score" class="absolute top-0 right-0 m-4 text-xl font-bold">Score: <span>0</span></div>
        </div>
        <input type="text" id="wordInput" class="w-full mt-4 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Type the word...">
    </div>
    <script>
        const gameEl = document.getElementById('game');
        const scoreEl = document.getElementById('score').querySelector('span');
        const wordInputEl = document.getElementById('wordInput');
        let player;
        let words = [];
        let score = 0;
        let gameLoop;
        const wordsArray = ['apple', 'banana', 'cherry', 'date', 'elderberry', 'fig', 'grape', 'honeydew', 'kiwi', 'lemon', 'mango', 'nectarine', 'orange', 'papaya', 'quince', 'raspberry', 'strawberry', 'tangerine', 'watermelon'];
        
        // Initialize the keys object to track key states
        const keys = {};

        function init() {
            player = document.createElement('div');
            player.classList.add('w-8', 'h-8', 'bg-blue-500', 'absolute', 'bottom-0', 'left-0');
            gameEl.appendChild(player);
            document.addEventListener('keydown', handleKeyDown);
            document.addEventListener('keyup', handleKeyUp); // Reset keys on keyup
            wordInputEl.addEventListener('input', checkWord);
            gameLoop = setInterval(gameUpdate, 1000 / 60);
        }

        function gameUpdate() {
            // Move player
            const playerSpeed = 5;
            if (keys['w']) player.style.bottom = `${player.offsetTop + playerSpeed}px`;
            if (keys['s']) player.style.bottom = `${player.offsetTop - playerSpeed}px`;
            if (keys['a']) player.style.left = `${player.offsetLeft - playerSpeed}px`;
            if (keys['d']) player.style.left = `${player.offsetLeft + playerSpeed}px`;

            // Spawn words
            if (Math.random() < 0.02) {
                const word = wordsArray[Math.floor(Math.random() * wordsArray.length)];
                const wordEl = document.createElement('div');
                wordEl.textContent = word;
                wordEl.classList.add('absolute', 'text-xl', 'font-bold');
                wordEl.style.left = `${Math.random() * (gameEl.clientWidth - 100)}px`;
                wordEl.style.top = `${Math.random() * (gameEl.clientHeight - 40)}px`;
                wordEl.dataset.startTime = Date.now(); // Set start time for scoring
                gameEl.appendChild(wordEl);
                words.push({ element: wordEl, word });
            }

            // Check collision with words
            words.forEach((word, i) => {
                if (isColliding(player, word.element)) {
                    wordInputEl.focus();
                    words.splice(i, 1);
                }
            });
        }

        function handleKeyDown(e) {
            keys[e.key] = true;
        }

        function handleKeyUp(e) {
            keys[e.key] = false; // Reset key state on keyup
        }

        function checkWord(e) {
            const currentWord = words.find(word => word.word === e.target.value);
            if (currentWord) {
                const wordEl = currentWord.element;
                const elapsedTime = Date.now() - parseInt(wordEl.dataset.startTime);
                const basePoints = 100;
                const timeBonus = 1000;
                const points = Math.round(basePoints + (timeBonus / elapsedTime) * 100);
                score += points;
                scoreEl.textContent = score;
                gameEl.removeChild(wordEl);
                words = words.filter(word => word !== currentWord);
                e.target.value = '';
            }
        }

        function isColliding(el1, el2) {
            const rect1 = el1.getBoundingClientRect();
            const rect2 = el2.getBoundingClientRect();
            return !(rect1.bottom < rect2.top || rect1.top > rect2.bottom || rect1.right < rect2.left || rect1.left > rect2.right);
        }

        init();
    </script>
</body>
</html>
